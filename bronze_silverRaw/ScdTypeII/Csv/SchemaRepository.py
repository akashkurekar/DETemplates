# Databricks notebook source
from pyspark.sql.types import *

# COMMAND ----------

schema_repository = {
    'EHSLocation': StructType([
  StructField('MappingName', StringType(), True),
  StructField('SourceKey', StringType(), True),
  StructField('SourceValue', StringType(), True),
  StructField('TargetKey', StringType(), True),
  StructField('TargetValue', StringType(), True),
  StructField('Comment', StringType(), True)
  ]),
    'Brookfield': StructType([
  StructField('Datetime', StringType(), True),
  StructField('Reader', StringType(), True),
  StructField('Event', StringType(), True),
  StructField('EventBadgeID', StringType(), True),
  StructField('CARDHOLDER_NAME', StringType(), True),
  StructField('EMPLOYEENUMBER', StringType(), True)
  ]),
    'ZPM_SM_TYPE': StructType([
   StructField('Language_Key', StringType(), True),
  StructField('Service_Master_Type', StringType(), True),
  StructField('SM_Type_Desciption', StringType(), True)
]),  
   'ZPM_INDIRECT_CD': StructType([
  StructField('Language_Key', StringType(), True),
  StructField('Indirect_Code', StringType(), True),
  StructField('Ind_Code_Desciption', StringType(), True)
]),  
  'ZPM_TA_SUP_V': StructType([
  StructField('Project_Definition', StringType(), True),
  StructField('Supervisor_Name', StringType(), True),
  StructField('Supervisor_Personnel_No/Dadge_No', StringType(), True),
  StructField('Start_Date', StringType(), True),
  StructField('Finish_Date', StringType(), True),
  StructField('Active', StringType(), True)
]), 
    'ZPM_TRADE_CODE': StructType([
  StructField('Language_Key', StringType(), True),
  StructField('Trade_Code', StringType(), True),
  StructField('Trade_Code_Desciption', StringType(), True)
]),
  'ZPM_SM_GR_TY_REL': StructType([
  StructField('Service_Master_Group', StringType(), True),
  StructField('Service_Master_Type', StringType(), True),
  StructField('End_Date', StringType(), True)
])  ,
    'ZPM_SM_GROUP': StructType([
  StructField('Language_Key', StringType(), True),
  StructField('Service_Master_Group', StringType(), True),
  StructField('SM_Group_Desciption', StringType(), True)
]) ,
  'SitePriceFileCreate' : StructType([
    StructField("TransactionDate", StringType(), True),        
    StructField("CCSProductCode", StringType(), True),
    StructField("PPassSiteCode", StringType(), True),
    StructField("BlanketType", StringType(), True),
    StructField("BlanketLevel", StringType(), True),
    StructField("PostedPrice", StringType(), True),
    StructField("Time", StringType(), True)
]),
  'BlanketLevelTextTable' : StructType([
    StructField("BlanketLevel", StringType(), True),        
    StructField("LanguageKey", StringType(), True),
    StructField("ShortDescription", StringType(), True),
    StructField("MediumDescription", StringType(), True)
]),
  'BlanketTypeTextTable' : StructType([
    StructField("BlanketType", StringType(), True),        
    StructField("LanguageKey", StringType(), True),
    StructField("ShortDescription", StringType(), True),
    StructField("MediumDescription", StringType(), True)
]),
  'CountryTable' : StructType([
  StructField("CountryKey", StringType(), True),        
  StructField("LanguageKey", StringType(), True),
  StructField("ShortDescription", StringType(), True)
]),
  'LanguageTable' : StructType([
  StructField("LanguageKey", StringType(), True),        
  StructField("LanguageCode", StringType(), True),
  StructField("ShortDescription", StringType(), True)
]),
 'PPassProductCode' : StructType([
StructField("PPassProductCode", StringType(), True),        
StructField("Material", StringType(), True),
StructField("CCSProductCode", StringType(), True),
StructField("CommissionIndicator", StringType(), True),        
StructField("PaddingRebateUpperLimitCADL", StringType(), True),
StructField("PetroPassReportingRelevant", StringType(), True),
StructField("PCTRelevant", StringType(), True),        
StructField("ProductHierLvl1", StringType(), True),
StructField("ProductHierLvl2", StringType(), True),
StructField("ProductHierLvl3", StringType(), True)
]),
  'PPassProductCodeText' : StructType([
StructField("PPassProductCode", StringType(), True),        
StructField("LanguageKey", StringType(), True),
StructField("MaterialDescription", StringType(), True)
]),
  'ProvinceState' : StructType([
StructField("CountryKey", StringType(), True),        
StructField("ProvinceState", StringType(), True),
StructField("Location", StringType(), True),
StructField("HouseNumberStreet", StringType(), True),        
StructField("LatitudeOfGeoLocation", StringType(), True),
StructField("LongitudeOfGeoLocation", StringType(), True)
]),    
  'ProvinceStateText' : StructType([
StructField("CountryKey", StringType(), True),        
StructField("ProvinceState", StringType(), True),
StructField("LanguageKey", StringType(), True),
StructField("ShortDescription", StringType(), True),        
StructField("MediumDescription", StringType(), True)
]), 

 'SiteTypeTextTable': StructType([
StructField("SiteType", StringType(), True),        
StructField("LanguageKey", StringType(), True),
StructField("MediumDescription", StringType(), True)
]),
 'rtmmast' : StructType([
StructField("AssociateNumber", StringType(), True),        
StructField("PPassSiteCode", StringType(), True),
StructField("Location", StringType(), True),
StructField("SiteType", StringType(), True),
StructField("OperatingModeFromRTM", StringType(), True),
StructField("ProvinceState", StringType(), True)
]),
 'ppasmast' : StructType([
StructField("PPassSiteCode", StringType(), True),        
StructField("AssociateNumber", StringType(), True),
StructField("StreetNumber", StringType(), True),
StructField("ProvinceState", StringType(), True),
StructField("SourceSiteCode", StringType(), True),
StructField("SiteType", StringType(), True),
StructField("Location", StringType(), True)
]),
 'cdr_head' : StructType([
StructField("Transaction_Date", StringType(), True),        
StructField("Transaction_Time", StringType(), True),
StructField("Associate_Number", StringType(), True),
StructField("PPts_Cust_ID", StringType(), True),
StructField("CRIND_Flg", StringType(), True),
StructField("MFilm_Num", StringType(), True),
StructField("GST", StringType(), True),
StructField("PST", StringType(), True),
StructField("PPts_Bal", StringType(), True),
StructField("Petro_Points_Earned", StringType(), True),
StructField("Petro_Points_Bonus", StringType(), True),
StructField("Cash_Back", StringType(), True),
StructField("PPts_Card_Un", StringType(), True),
StructField("PPD_Ind", StringType(), True)
]),
 'cdr_payt' : StructType([
StructField("CCS_Account_Number", StringType(), True),        
StructField("Pay_Meth", StringType(), True),
StructField("MFilm_Num", StringType(), True),
StructField("Pay_Amt", StringType(), True),
StructField("CCS_Card_Number", StringType(), True)
]),
 'cdr_prod' : StructType([
StructField("Host_Code", StringType(), True),        
StructField("MFilm_Num", StringType(), True),
StructField("Sales_Quantity", StringType(), True),
StructField("Sale", StringType(), True),
StructField("GST", StringType(), True),
StructField("PST", StringType(), True)
]),
 'cdr_comm_head' : StructType([
StructField("Transaction_Date", StringType(), True),        
StructField("Associate_Number", StringType(), True),
StructField("CCS_Account_Number", StringType(), True),
StructField("MFilm_Num", StringType(), True),
StructField("CCS_Card_Number", StringType(), True),
StructField("Original_CCS_Account", StringType(), True),
StructField("Currency", StringType(), True),
StructField("CurrencyB", StringType(), True),
StructField("Fuel_Disc", StringType(), True),
StructField("Othr_Disc", StringType(), True)
]),
 'cdr_comm_prod' : StructType([
StructField("MFilm_Num", StringType(), True),        
StructField("Host_Code", StringType(), True),
StructField("Sales_Quantity", StringType(), True),
StructField("Sale", StringType(), True),
StructField("FET", StringType(), True),
StructField("FET_ADD", StringType(), True),
StructField("PFT", StringType(), True),
StructField("SCBC_Transit_Tax", StringType(), True),
StructField("GST", StringType(), True),
StructField("PST", StringType(), True),
StructField("Fuel_Disc", StringType(), True)
]),
 'IslandFerryTime' : StructType([
StructField("ContinentIsland", StringType(), True),        
StructField("FerryFactor", StringType(), True),
StructField("ContinentIslandDescription", StringType(), True)
]),
  'LatitudeLongitudePetropassSites' : StructType([
StructField("Cl", StringType(), True),        
StructField("PPassSiteCode", StringType(), True),
StructField("Latitude", StringType(), True),
StructField("Longitude", StringType(), True),
StructField("TimeZone", StringType(), True)
]),
   'LatitudeLongitudeRetailSites' : StructType([
StructField("Cl", StringType(), True),        
StructField("AssociateNumber", StringType(), True),
StructField("Latitude", StringType(), True),
StructField("Longitude", StringType(), True),
StructField("TimeZone", StringType(), True)
]),
   'PP&RetailSitesOnIslands' : StructType([
StructField("AssociateNumber", StringType(), True),        
StructField("PP&RetailSitesOn", StringType(), True),
StructField("ContinentIsland", StringType(), True)
]),
  'lvhv_lvl_3_spend' : StructType([
StructField("Transaction_ID", StringType(), True), 
StructField("Cardholder_Name", StringType(), True), 
StructField("CH_NAME_LINE_2", StringType(), True), 
StructField("Card_Hierarchy_Number", StringType(), True),
StructField("Card_Hierarchy_Description", StringType(), True), 
StructField("Merchant_Name", StringType(), True), 
StructField("Merchant_Location", StringType(), True), 
StructField("Merchant_ID", StringType(), True), 
StructField("MCC", StringType(), True), 
StructField("MCC_Description", StringType(), True), 
StructField("Merchant_City", StringType(), True), 
StructField("Merchant_Zip", StringType(), True), 
StructField("Merchant_Phone", StringType(), True), 
StructField("Merchant_Tax_ID", StringType(), True), 
StructField("Merchant_VAT_Number", StringType(), True), 
StructField("Date_Occurred", StringType(), True), 
StructField("Date_Posted", StringType(), True), 
StructField("Settlement_Amount", StringType(), True), 
StructField("Sales_Tax", StringType(), True), 
StructField("Local_Tax_Amount", StringType(), True), 
StructField("Transaction_Description", StringType(), True), 
StructField("Reference_Number", StringType(), True), 
StructField("Purch_Description", StringType(), True), 
StructField("Purch_Quantity", StringType(), True), 
StructField("Purch_Unit_Cost", StringType(), True), 
StructField("Purch_Unit_Measure", StringType(), True), 
StructField("Purch_Extended_Amount", StringType(), True), 
StructField("SKU_Number", StringType(), True), 
StructField("Commodity_Code", StringType(), True), 
StructField("Customer_Reference_Number", StringType(), True), 
StructField("Company", StringType(), True), 
StructField("GL", StringType(), True), 
StructField("Cost_Center", StringType(), True), 
StructField("WBS", StringType(), True), 
StructField("Network", StringType(), True), 
StructField("Activity", StringType(), True), 
StructField("Internal_Order", StringType(), True), 
StructField("Postal_Code", StringType(), True), 
StructField("Orig_Currency_Code", StringType(), True), 
StructField("Orig_Currency_Amt", StringType(), True), 
StructField("Blling_Currency_Code", StringType(), True),
StructField("Authorization_Code", StringType(), True)
]),

'Pdi_Site_Code' : StructType([
StructField("Pdi_Site_Code", StringType(), True),        
StructField("Associate_Number", StringType(), True),
StructField("Street_Name", StringType(), True),
StructField("Location", StringType(), True),
StructField("Country", StringType(), True),
StructField("Region", StringType(), True),
StructField("Postal_Code", StringType(), True),
StructField("Latitude", DecimalType(15,12), True),
StructField("Longitude", DecimalType(15,12), True),
StructField("Sales_Org", StringType(), True),
StructField("Sales_Grp", StringType(), True),
StructField("Sales_Office", StringType(), True),
StructField("Diesel_Indicator", StringType(), True),
StructField("Full_Self_Serve", StringType(), True),
StructField("Kent_Id", StringType(), True),
StructField("Account_Type", StringType(), True),
StructField("Brand", StringType(), True),
StructField("Outlet_Number", StringType(), True)
]),
'Product_Code_Desc' : StructType([
StructField("PDI_Product_Code", StringType(), True),        
StructField("Language_Key", StringType(), True),
StructField("Short_Description", StringType(), True),
StructField("Medium_Description", StringType(), True)
]),
'LongitudeLatitudePetropass&RetailFiles' : StructType([
StructField("PPassSiteCode", StringType(), True),        
StructField("AssociateNumber", StringType(), True),
StructField("PP&RetailSitesOn", StringType(), True),
StructField("Latitude", StringType(), True),
StructField("Longitude", StringType(), True),        
StructField("TimeZone", StringType(), True),
StructField("ContinentIsland", StringType(), True),
StructField("Country", StringType(), True),
StructField("ProvinceState", StringType(), True),
StructField("Location", StringType(), True),        
StructField("AssociateDescription", StringType(), True),
StructField("FerryFactor", StringType(), True)
]),
'CdrSales' : StructType([
StructField("PetroPassRecordType",StringType(), True),
StructField("RegionSiteCode",StringType(), True),
StructField("BatchNumber",StringType(), True),
StructField("PetroPassSiteCode",StringType(), True),
StructField("PetroPassTransactionNumber",StringType(), True),
StructField("SourceSiteCode",StringType(), True),
StructField("CCSAccountNumber",StringType(), True),
StructField("PriceLinkAccount",StringType(), True),
StructField("CCSCardNumber",StringType(), True),
StructField("PumpNumber",StringType(), True),
StructField("SourceInCode",StringType(), True),
StructField("PPassProductCode",StringType(), True),
StructField("CCSProductCode",StringType(), True),
StructField("TransactionPricingDate",StringType(), True),
StructField("TransactionPricingTime",StringType(), True),
StructField("DateTransactionReceived",StringType(), True),
StructField("TimeTransactionReceived",StringType(), True),
StructField("TransactionStatusCode",StringType(), True),
StructField("BlanketType",StringType(), True),
StructField("TransactionKBE",StringType(), True),
StructField("TransactionODM",StringType(), True),
StructField("AssociateNumber",StringType(), True),
StructField("CommissionAccountNumber",StringType(), True),
StructField("SalesQuantity",StringType(), True),
StructField("Revenue",StringType(), True),
StructField("ProductPrice",StringType(), True),
StructField("UnSalesQuantity",StringType(), True),
StructField("ExchangeRateForPricingAndStatistics",StringType(), True),
StructField("MISBatch",StringType(), True),
StructField("TransactionStatusDate",StringType(), True),
StructField("ProvincialCarbonTax",StringType(), True),
StructField("ProvincialFuelsTax",StringType(), True),
StructField("ProvincialSalesTax",StringType(), True),
StructField("SCBCTransitTax",StringType(), True),
StructField("GSTHSTTax",StringType(), True),
StructField("FederalExciseTax",StringType(), True),
StructField("CardType",StringType(), True),
StructField("DesNonDes",StringType(), True),
StructField("AccountNoMem",StringType(), True),
StructField("ProvinceState",StringType(), True),
StructField("DiscountOrSurchargOnBlanket",StringType(), True),
StructField("BlanketLevel",StringType(), True),
StructField("MISDocument",StringType(), True),
StructField("ProductTransferPrice",StringType(), True),
StructField("BioFuel",StringType(), True),
StructField("CCSCardNumber1",StringType(), True),
StructField("FederalCarbonTax",StringType(), True),
StructField("OtherTaxDollar1",StringType(), True),
StructField("OtherTaxDollar2",StringType(), True),
StructField("RackPVEffectiveDate",StringType(), True),
StructField("RackPVEffectiveTime",StringType(), True)
]),
'FixedComm' : StructType([
StructField("OutletNumber", StringType(), True),        
StructField("EffectiveDate", StringType(), True),
StructField("FixedCommissionPerMonth", StringType(), True),
StructField("LandLeasePerMonth", StringType(), True),
StructField("LandLeasePerLitre", StringType(), True),        
StructField("OtherPerMonth", StringType(), True),
StructField("OtherPerLitre", StringType(), True),
StructField("LicenseFeePerMonth", StringType(), True),
StructField("SiteCode", StringType(), True),
StructField("Province", StringType(), True),        
StructField("SiteName", StringType(), True),
StructField("Comments", StringType(), True),
StructField("SiteType", StringType(), True),
StructField("OperatingMode", StringType(), True)
]),
'PaddingRebate' : StructType([
StructField("AccountNumber", StringType(), True),        
StructField("SAPMaterialNumber", StringType(), True),
StructField("Country", StringType(), True),
StructField("ProvinceState", StringType(), True),
StructField("PPassSiteCode", StringType(), True),        
StructField("EffectiveDate", StringType(), True),
StructField("PaddingRebateRate", StringType(), True),
StructField("Comments", StringType(), True)
]),
'DimFacilityType' : StructType([
StructField("FacilityTypeAssociationCode", StringType(), True),     
StructField("FacilityTypeCode", StringType(), True),        
StructField("FacilityTypeName", StringType(), True),
StructField("FacilityTypeDescription", StringType(), True)
]),
'BudgetYearly' : StructType([
StructField("Year", StringType(), True),        
StructField("Budget", StringType(), True),
StructField("OPEXBudget", StringType(), True)
]),
'CTS133Data' : StructType([
StructField("EquipmentClassCode", StringType(), True),     
StructField("EquipmentClassDescription", StringType(), True),        
StructField("EquipmentObjectTypeCode", StringType(), True),
StructField("EquipmentObjectTypeDescription", StringType(), True),
StructField("EquipmentCategoryCode", StringType(), True),     
StructField("EquipmentCategoryDescription", StringType(), True),        
StructField("EquipmentCategoryDefinition", StringType(), True),     
StructField("CfihosCode", StringType(), True),        
StructField("StdRevisionNumber", StringType(), True),     
StructField("StdRevisionDate", StringType(), True)
]),
'WorkerDetails' : StructType([
StructField("Employee_ID",IntegerType(),True),
StructField("Full_Legal_Name",StringType(),True),
StructField("First_Name",StringType(),True),
StructField("Legal_Last_Name",StringType(),True),
StructField("Preferred_Name-First_Name",StringType(),True),
StructField("Position_ID",StringType(),True),
StructField("Position",StringType(),True),
StructField("Business_Title",StringType(),True),
StructField("Job_Profile_ID",StringType(),True),
StructField("Job_Title",StringType(),True),
StructField("Job_Family",StringType(),True),
StructField("Job_Family_Group",StringType(),True),
StructField("Worker_Type",StringType(),True),
StructField("Employee_Type",StringType(),True),
StructField("Time_Type",StringType(),True),
StructField("Pay_Rate_Type",StringType(),True),
StructField("Length_Of_Service_at_Year-End",StringType(),True),
StructField("Service_Anniversary_Month",StringType(),True),
StructField("Management_Level",StringType(),True),
StructField("Manager_ID",StringType(),True),
StructField("Workers_Manager",StringType(),True),
StructField("Manager_Position_ID",StringType(),True),
StructField("Manager_Position",StringType(),True),
StructField("Manager_Email_Address",StringType(),True),
StructField("Org_ID",StringType(),True),
StructField("Organization_Name",StringType(),True),
StructField("Org_Level_3_ID",StringType(),True),
StructField("Org_Level_3",StringType(),True),
StructField("Org_Level_4_ID",StringType(),True),
StructField("Org_Level_4",StringType(),True),
StructField("Org_Level_5_ID",StringType(),True),
StructField("Org_Level_5",StringType(),True),
StructField("Org_Level_6_ID",StringType(),True),
StructField("Org_Level_6",StringType(),True),
StructField("Org_Level_7_ID",StringType(),True),
StructField("Org_Level_7",StringType(),True),
StructField("Org_Level_8_ID",StringType(),True),
StructField("Org_Level_8",StringType(),True),
StructField("Default_Cost_Center_ID",StringType(),True),
StructField("Default_Cost_Center",StringType(),True),
StructField("Costing_Allocation_Cost_Center",StringType(),True),
StructField("Company-ID",StringType(),True),
StructField("Company",StringType(),True),
StructField("Location",StringType(),True),
StructField("Location_ID",StringType(),True),
StructField("City",StringType(),True),
StructField("Region",StringType(),True),
StructField("Country",StringType(),True),
StructField("Work_Schedule_Calendars",StringType(),True),
StructField("Is_FIFO",StringType(),True),
StructField("Email-Primary_Work",StringType(),True),
StructField("Preferred_Communication_Language",StringType(),True),
StructField("Preferred_Display_Language",StringType(),True)
]),
'ProductiveHours' : StructType([
StructField('Pers__No', IntegerType(), True),
StructField('Name', StringType(), True),
StructField('Date', StringType(), True),
StructField('Scheduled_Hours_for_a_Day', DoubleType(), True),
StructField('Absent_Hours', DoubleType(), True),
StructField('Additional_Hours', DoubleType(), True),
StructField('Productive_Hours', DoubleType(), True),
StructField('Mutual_Exists?', StringType(), True),
StructField('Work_Schedule_Calendars', StringType(), True),
StructField('Job_Title', StringType(), True),
StructField('Location', StringType(), True),
StructField('Management_Level', StringType(), True),
StructField('Union', StringType(), True),
StructField('Job_Family', StringType(), True),
StructField('Department_and_Work_Area', StringType(), True),
StructField('Employee_Type', StringType(), True),
StructField('Time_Type', StringType(), True),
StructField('FTE', DoubleType(), True),
StructField('Pay_Rate_Type', StringType(), True),
StructField('Company', StringType(), True),
StructField('Supervisory_Organization', StringType(), True),
StructField('Org_Level_3', StringType(), True),
StructField('Org_Level_4', StringType(), True),
StructField('Org_Level_5', StringType(), True),
StructField('Org_Level_6', StringType(), True),
StructField('Org_Level_7', StringType(), True),
StructField('Org_Level_8', StringType(), True)
]),
'SupervisoryOrganizations' : StructType([
StructField('Org_Name', StringType(), True),
StructField('Org_ID', StringType(), True),
StructField('Default_Cost_Center', StringType(), True),
StructField('Default_Company', StringType(), True),
StructField('Supervisory_Org_Manager_Employee_ID', StringType(), True),
StructField('Supervisory_Org_Manager', StringType(), True),
StructField('Supervisory_Org_Manager_Position_ID', StringType(), True),
StructField('Supervisory_Org_Manager_Position', StringType(), True),
StructField('Organization_Level_from_Top', StringType(), True),
StructField('Availability_Date', StringType(), True),
StructField('Created_Moment', StringType(), True),
StructField('Location-Primary', StringType(), True),
StructField('Visibility', StringType(), True),
StructField('Subtype', StringType(), True),
StructField('Staffing_Model', StringType(), True),
StructField('Org_Level_3_ID', StringType(), True),
StructField('Org_Level_3_Name', StringType(), True),
StructField('Org_Level_4_ID', StringType(), True),
StructField('Org_Level_4_Name', StringType(), True),
StructField('Org_Level_5_ID', StringType(), True),
StructField('Org_Level_5_Name', StringType(), True),
StructField('Org_Level_6_ID', StringType(), True),
StructField('Org_Level_6_Name', StringType(), True),
StructField('Org_Level_7_ID', StringType(), True),
StructField('Org_Level_7_Name', StringType(), True),
StructField('Org_Level_8_ID', StringType(), True),
StructField('Org_Level_8_Name', StringType(), True)
])
}